# AutoSpec

Консольная утилита для подготовки файлов спецификаций из инвойсов. Создаёт копии книг Excel с единственным видимым листом «Specification» в формате XLSX или XLS, а также удаляет ранее созданные файлы спецификаций.

## Требования

- **Windows** (для сценария XLS используется Excel через COM)
- **Python 3.6+**
- **Microsoft Excel** — только для сценария «Создание файла спецификации XLS» (сценарий 2)

## Установка и запуск

1. Склонируйте или скопируйте папку проекта.
2. Запустите скрипт:
   ```bash
   python AutoSpec.py
   ```
   Либо дважды запустите `AutoSpec.py` из проводника (если Python в PATH).

При **первом запуске** скрипт проверяет наличие библиотек (`openpyxl`, `colorama`, `pywin32`). Если какой-то модуль отсутствует, автоматически выполняется установка из `requirements.txt`, после чего скрипт перезапускается и открывается меню. Ручная установка возможна так:

```bash
pip install -r requirements.txt
```

## Конфигурация

В папке со скриптом создаётся файл `config.json`, в котором сохраняется путь к директории с инвойсами (`base_dir`). При следующем запуске путь подставляется автоматически; его можно изменить через пункт меню **3**.

## Меню сценариев

| Пункт | Действие |
|-------|----------|
| **1** | Создание файла спецификации **XLSX** — копия `Invoice N.xlsx` → `Invoice N fcs.xlsx`, в копии виден только лист «Specification». |
| **2** | Создание файла спецификации **XLS** — то же через Excel COM, результат `Invoice N fcs.xls`. Требуется установленный Excel. |
| **3** | Изменить путь к директории с инвойсами. |
| **4** | Удаление файлов спецификаций — удаляет в папках файлы вида `* fcs.xlsx` и `* fcs.xls`. Можно обработать все папки (Enter) или указать диапазон номеров. |
| **0** | Выход. |

## Диапазон номеров инвойсов

После выбора сценария 1 или 2 программа запрашивает номера инвойсов.

**Для сценария 4 (удаление)** предлагается:
- **Нажмите Enter** (зелёным) — удаление fcs-файлов во **всех** папках с инвойсами в базовой директории;
- **или укажите диапазон номеров** (жёлтым) — удаление только в папках с выбранными номерами.

Формат ввода диапазона (сценарии 1, 2 и 4):

- отдельные номера: `1`, `5`, `10`
- диапазоны: `1-5`, `10-12`
- комбинации через запятую или точку с запятой: `1, 3, 5-7`, `1; 2; 3-5`

Скрипт ищет **папки**, в имени которых в начале встречается указанный номер (например, папка `123 Инвойс` подойдёт для номера `123`). В каждой такой папке для сценариев 1 и 2 ожидается файл `Invoice N.xlsx` (где N — номер).

## Структура папок

```
base_dir/
├── 1 Инвойс/
│   └── Invoice 1.xlsx
├── 2 Инвойс/
│   └── Invoice 2.xlsx
└── 5 Какой-то инвойс/
    └── Invoice 5.xlsx
```

В книге должен быть лист с именем **Specification** (без кавычек в имени).

## Зависимости (requirements.txt)

- `openpyxl` — работа с .xlsx
- `colorama` — цветной вывод в консоль
- `pywin32` — доступ к Excel для сохранения в .xls

## Лицензия

Свободное использование в рамках ваших задач.
